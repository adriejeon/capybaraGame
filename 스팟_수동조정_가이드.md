# 틀린그림찾기 스팟 수동 조정 가이드

## 🔍 문제 원인

### 1. 자동 감지의 한계
- OpenCV는 **픽셀 차이**를 기반으로 감지
- 실제 게임에서는 **사용자 클릭 위치**와 스팟 중심점의 **거리**로 판단
- 이미지 비율, 터치 좌표 변환 과정에서 오차 발생
- `BoxFit.cover` 사용 시 이미지가 잘려서 좌표 매칭 실패

### 2. 해결 방법
✅ **`BoxFit.contain`으로 변경** - 이미지 전체 표시  
✅ **디버그 모드 활성화** - 스팟 위치 시각화  
✅ **수동 스팟 조정** - 정확한 좌표 설정

---

## 📝 수동 스팟 조정 방법

### Step 1: 디버그 모드로 정확한 좌표 확인

1. **앱 실행** 후 틀린그림찾기 게임 시작
2. **디버그 모드가 활성화**되어 있으면:
   - 모든 스팟 위치가 **빨간 원**으로 표시됨
   - 스팟 번호가 표시됨
   - 스팟 반경이 **반투명 원**으로 표시됨
3. **실제 차이점을 클릭**하면:
   - 상단에 **터치 좌표**가 표시됨 (예: `x: 0.50, y: 0.55`)
   - 콘솔에 상세 로그 출력

### Step 2: 스팟 좌표 수정

1. **파일 열기**: `lib/game/models/spot_difference_data.dart`
2. **해당 스테이지 찾기**: 예) `'1-2': [...]`
3. **좌표 수정**:
   ```dart
   '1-2': [
     const DifferenceSpot(x: 0.50, y: 0.55, radius: 0.12),  // 담요
     const DifferenceSpot(x: 0.15, y: 0.25, radius: 0.08),  // 화분
     const DifferenceSpot(x: 0.10, y: 0.20, radius: 0.06),  // 책
   ],
   ```

### Step 3: 반경(radius) 조정

- **작은 차이** (예: 작은 점, 선): `radius: 0.05 ~ 0.06`
- **중간 차이** (예: 작은 물체): `radius: 0.08 ~ 0.10`
- **큰 차이** (예: 큰 물체, 패턴): `radius: 0.12 ~ 0.15`

---

## 🎯 각 스테이지별 수동 조정 가이드

### 1-2 스테이지 (침대에서 자는 카피바라)

**실제 차이점:**
1. **담요 폴카닷** - 카피바라 몸 위 담요의 일부 폴카닷이 사라짐
   - 예상 좌표: `x: 0.50, y: 0.55`
   - 반경: `0.12` (담요 영역이 넓음)

2. **화분 잎 색상** - 왼쪽 창문 위 화분의 잎이 초록 → 빨강
   - 예상 좌표: `x: 0.15, y: 0.25`
   - 반경: `0.08`

3. **책 개수** - 창문 위 책이 하나 사라짐
   - 예상 좌표: `x: 0.10, y: 0.20`
   - 반경: `0.06`

**조정 방법:**
1. 디버그 모드에서 각 차이점을 클릭
2. 표시된 터치 좌표를 기록
3. `spot_difference_data.dart`에서 해당 좌표로 수정

---

## 🔧 디버그 모드 사용법

### 현재 디버그 기능

1. **스팟 위치 표시**:
   - 빨간 원: 아직 찾지 못한 스팟
   - 초록 원: 찾은 스팟
   - 번호: 스팟 순서
   - 반투명 원: 스팟 반경

2. **터치 좌표 표시**:
   - 상단 정보 바에 터치 좌표 표시
   - 콘솔에 상세 로그 출력

3. **스테이지 정보**:
   - AppBar에 현재 스테이지 번호 표시

### 디버그 모드 끄기

`spot_difference_screen.dart` 파일에서:
```dart
static const bool _debugMode = false;  // true -> false로 변경
```

---

## 📊 스팟 좌표 시스템

### 좌표 범위
- `x`: 0.0 ~ 1.0 (이미지 너비 기준)
- `y`: 0.0 ~ 1.0 (이미지 높이 기준)
- `radius`: 0.0 ~ 1.0 (이미지 너비 기준)

### 예시
- `x: 0.5, y: 0.5` = 이미지 정중앙
- `x: 0.25, y: 0.30` = 왼쪽 위쪽 영역
- `radius: 0.10` = 이미지 너비의 10% 반경

---

## ⚠️ 주의사항

1. **이미지 비율**: 각 이미지의 실제 비율이 다를 수 있음
   - 1-6: 1024x448 (비율 0.4375)
   - 나머지: 1024x572 (비율 0.56)

2. **BoxFit.contain**: 이미지가 컨테이너 안에 맞춰지므로 여백이 생길 수 있음
   - 터치 좌표는 이미지 영역 기준으로 계산됨

3. **스팟 개수**: 레벨별로 정해진 개수만큼만 설정
   - 레벨 1: 3개
   - 레벨 2: 4개
   - 레벨 3: 5개
   - 레벨 4: 5개
   - 레벨 5: 6개

---

## 🚀 빠른 수정 체크리스트

- [ ] 디버그 모드 활성화 확인 (`_debugMode = true`)
- [ ] 앱 실행 후 해당 스테이지 플레이
- [ ] 실제 차이점 클릭하여 좌표 확인
- [ ] `spot_difference_data.dart`에서 좌표 수정
- [ ] 반경 조정 (너무 크면 쉬워지고, 너무 작으면 어려워짐)
- [ ] 앱 재시작 후 테스트
- [ ] 모든 스팟이 정확히 작동하는지 확인

---

## 💡 팁

1. **힌트 기능 활용**: 힌트를 사용하면 아직 찾지 못한 스팟 위치를 확인할 수 있음
2. **확대 기능**: 이미지를 확대해서 정확한 위치 확인
3. **콘솔 로그**: 터치 시 콘솔에 상세 정보 출력됨
4. **반복 테스트**: 수정 후 여러 번 테스트하여 정확도 확인
